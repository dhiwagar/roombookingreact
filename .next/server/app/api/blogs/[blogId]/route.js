"use strict";(()=>{var e={};e.id=171,e.ids=[171],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9044:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>b,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m});var r={};o.r(r),o.d(r,{DELETE:()=>g,GET:()=>d,PUT:()=>c});var n=o(9303),s=o(8716),i=o(670),a=o(7070),l=o(2021),u=o(6852);async function d(e,{params:t}){try{await (0,l.Z)();let e=await u.Z.findOne({blogId:t.blogId});if(!e)return a.NextResponse.json({success:!1,error:"Blog not found"},{status:404});return e.isPublished&&await u.Z.findOneAndUpdate({blogId:t.blogId},{$inc:{views:1}}),a.NextResponse.json({success:!0,data:e})}catch(e){return console.error("Error fetching blog:",e),a.NextResponse.json({success:!1,error:"Failed to fetch blog"},{status:500})}}async function c(e,{params:t}){try{await (0,l.Z)();let o=await e.json();if(o.title&&(o.slug=o.title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")),o.isPublished){let e=await u.Z.findOne({blogId:t.blogId});e&&!e.isPublished&&(o.publishedAt=new Date)}let r=await u.Z.findOneAndUpdate({blogId:t.blogId},o,{new:!0,runValidators:!0});if(!r)return a.NextResponse.json({success:!1,error:"Blog not found"},{status:404});return a.NextResponse.json({success:!0,data:r})}catch(e){return console.error("Error updating blog:",e),a.NextResponse.json({success:!1,error:"Failed to update blog"},{status:500})}}async function g(e,{params:t}){try{if(await (0,l.Z)(),!await u.Z.findOneAndDelete({blogId:t.blogId}))return a.NextResponse.json({success:!1,error:"Blog not found"},{status:404});return a.NextResponse.json({success:!0,message:"Blog deleted successfully"})}catch(e){return console.error("Error deleting blog:",e),a.NextResponse.json({success:!1,error:"Failed to delete blog"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/blogs/[blogId]/route",pathname:"/api/blogs/[blogId]",filename:"route",bundlePath:"app/api/blogs/[blogId]/route"},resolvedPagePath:"C:\\Users\\kepre\\Downloads\\room-booking\\room-booking\\app\\api\\blogs\\[blogId]\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:b,staticGenerationAsyncStorage:m,serverHooks:f}=p,h="/api/blogs/[blogId]/route";function y(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}},2021:(e,t,o)=>{o.d(t,{Z:()=>a});var r=o(1185),n=o.n(r);let s=process.env.MONGODB_URI||"mongodb://localhost:27017/villa-shanti";if(!s)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose;i||(i=global.mongoose={conn:null,promise:null});let a=async function(){if(i.conn)return i.conn;i.promise||(i.promise=n().connect(s,{bufferCommands:!1}).then(e=>e));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}},6852:(e,t,o)=>{o.d(t,{Z:()=>i});var r=o(1185),n=o.n(r);let s=new r.Schema({blogId:{type:String,required:!0,unique:!0,trim:!0},title:{type:String,required:!0,trim:!0,maxlength:200},content:{type:String,required:!0},excerpt:{type:String,required:!0,maxlength:300},author:{type:String,required:!0,trim:!0},category:{type:String,required:!0,enum:["news","events","promotions","lifestyle","food","travel"]},tags:[{type:String,trim:!0}],image:{type:String,required:!0,trim:!0},isPublished:{type:Boolean,default:!1},publishedAt:{type:Date},views:{type:Number,default:0},slug:{type:String,required:!0,unique:!0,trim:!0}},{timestamps:!0});s.index({category:1}),s.index({isPublished:1}),s.index({publishedAt:-1});let i=n().models.Blog||n().model("Blog",s)}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[276,972],()=>o(9044));module.exports=r})();