"use strict";(()=>{var e={};e.id=669,e.ids=[669],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},591:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>b,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{GET:()=>p,POST:()=>c});var o=r(9303),n=r(8716),i=r(670),s=r(7070),l=r(2021),u=r(1651);async function p(e){try{await (0,l.Z)();let{searchParams:t}=new URL(e.url),r=parseInt(t.get("page")||"1"),a=parseInt(t.get("limit")||"10"),o=t.get("location"),n=t.get("isAvailable"),i={};o&&(i.location=o),null!=n&&(i.isAvailable="true"===n);let p=(r-1)*a,c=await u.Z.find(i).sort({createdAt:-1}).skip(p).limit(a),d=await u.Z.countDocuments(i);return s.NextResponse.json({success:!0,data:c,pagination:{page:r,limit:a,total:d,pages:Math.ceil(d/a)}})}catch(e){return console.error("Error fetching tables:",e),s.NextResponse.json({success:!1,error:"Failed to fetch tables"},{status:500})}}async function c(e){try{await (0,l.Z)();let t=await e.json(),r=Date.now().toString(36),a=Math.random().toString(36).substring(2,8),o=`TBL-${r}-${a}`.toUpperCase(),n=new u.Z({...t,tableId:o});return await n.save(),s.NextResponse.json({success:!0,data:n},{status:201})}catch(e){return console.error("Error creating table:",e),s.NextResponse.json({success:!1,error:"Failed to create table"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/tables/route",pathname:"/api/tables",filename:"route",bundlePath:"app/api/tables/route"},resolvedPagePath:"C:\\Users\\kepre\\Downloads\\room-booking\\room-booking\\app\\api\\tables\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:b}=d,h="/api/tables/route";function v(){return(0,i.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:g})}},2021:(e,t,r)=>{r.d(t,{Z:()=>s});var a=r(1185),o=r.n(a);let n=process.env.MONGODB_URI||"mongodb://localhost:27017/villa-shanti";if(!n)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose;i||(i=global.mongoose={conn:null,promise:null});let s=async function(){if(i.conn)return i.conn;i.promise||(i.promise=o().connect(n,{bufferCommands:!1}).then(e=>e));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}},1651:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(1185),o=r.n(a);let n=new a.Schema({tableId:{type:String,required:!0,unique:!0,trim:!0},name:{type:String,required:!0,trim:!0},capacity:{type:Number,required:!0,min:1,max:20},location:{type:String,required:!0,enum:["indoor","outdoor","private","bar"]},isAvailable:{type:Boolean,default:!0},price:{type:Number,required:!0,min:0},description:{type:String,trim:!0,maxlength:500},image:{type:String,trim:!0}},{timestamps:!0});n.index({location:1}),n.index({isAvailable:1});let i=o().models.Table||o().model("Table",n)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,972],()=>r(591));module.exports=a})();