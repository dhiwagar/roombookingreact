"use strict";(()=>{var e={};e.id=386,e.ids=[386],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1212:e=>{e.exports=require("async_hooks")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},3757:e=>{e.exports=import("prettier/plugins/html")},5747:e=>{e.exports=import("prettier/standalone")},4492:e=>{e.exports=require("node:stream")},6238:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>f,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{GET:()=>l,POST:()=>d});var a=r(9303),o=r(8716),n=r(670),i=r(7070),c=r(2021),u=r(6827),p=r(7149);async function l(e){try{await (0,c.Z)();let{searchParams:t}=new URL(e.url),r=t.get("status"),s=parseInt(t.get("page")||"1"),a=parseInt(t.get("limit")||"10"),o={};r&&(o.status=r);let n=(s-1)*a,p=await u.Z.find(o).sort({createdAt:-1}).skip(n).limit(a),l=await u.Z.countDocuments(o);return i.NextResponse.json({success:!0,data:p,pagination:{page:s,limit:a,total:l,pages:Math.ceil(l/a)}})}catch(e){return console.error("Error fetching contacts:",e),i.NextResponse.json({success:!1,error:"Failed to fetch contacts"},{status:500})}}async function d(e){try{await (0,c.Z)();let{name:t,email:r,subject:s,message:a}=await e.json();if(!t||!r||!s||!a)return i.NextResponse.json({success:!1,error:"All fields are required"},{status:400});let o=new u.Z({name:t,email:r,subject:s,message:a});await o.save();try{let e=await (0,p.X)({name:t,email:r,subject:s,message:a});console.log("Contact email result:",e)}catch(e){console.error("Contact email sending failed:",e)}return i.NextResponse.json({success:!0,data:o,message:"Contact form submitted successfully! We'll get back to you soon."},{status:201})}catch(e){return console.error("Error creating contact:",e),i.NextResponse.json({success:!1,error:"Failed to submit contact form"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/contact/route",pathname:"/api/contact",filename:"route",bundlePath:"app/api/contact/route"},resolvedPagePath:"C:\\Users\\kepre\\Downloads\\room-booking\\room-booking\\app\\api\\contact\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:x,serverHooks:h}=m,w="/api/contact/route";function f(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:x})}},6827:(e,t,r)=>{r.d(t,{Z:()=>n});var s=r(1185),a=r.n(s);let o=new s.Schema({name:{type:String,required:!0,trim:!0,maxlength:100},email:{type:String,required:!0,trim:!0,lowercase:!0,match:[/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/,"Please enter a valid email"]},subject:{type:String,required:!0,trim:!0,maxlength:200},message:{type:String,required:!0,trim:!0,maxlength:2e3},status:{type:String,enum:["new","read","replied"],default:"new"}},{timestamps:!0});o.index({email:1}),o.index({status:1}),o.index({createdAt:-1});let n=a().models.Contact||a().model("Contact",o)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972,511],()=>r(6238));module.exports=s})();